<script>
  function crearTablaContactos() {
  let tabla = document.getElementById("tablaContactos");
  if (tabla) tabla.remove();

  google.script.run
    .withSuccessHandler(function (datos) {
      const tabla = construirTabla(datos);
      document.getElementById("divContactos").appendChild(tabla);
    })
    .withFailureHandler(function (error) {
      console.log("Error al obtener los contactos:", error);
    })
    .obtenerContactos();
}

function construirTabla(datos) {
  const tabla = document.createElement("table");
  tabla.id = "tablaContactos";

  // Crea el encabezado de la tabla
  const encabezado = document.createElement("thead");
  const primeraFila = document.createElement("tr");
  datos[0].forEach(function (valor) {
    const celda = document.createElement("th");
    celda.textContent = valor;
    primeraFila.appendChild(celda);
  });
  encabezado.appendChild(primeraFila);
  tabla.appendChild(encabezado);

  // Crea el cuerpo de la tabla
  const cuerpo = document.createElement("tbody");
  datos.slice(1).forEach(function (fila) {
    const nuevaFila = document.createElement("tr");
    fila.forEach(function (valor) {
      const celda = document.createElement("td");
      celda.textContent = valor;
      nuevaFila.appendChild(celda);
    });
    cuerpo.appendChild(nuevaFila);
  });
  tabla.appendChild(cuerpo);

  // Agrega clases a la tabla y al encabezado
  tabla.classList.add("table", "table-striped", "border", "border-3", "table-dark");
  encabezado.classList.add("table-success");

  return tabla;
}

</script>
